{% extends "_layouts/base.html" %}
{% load staticfiles %}
{% load djangular_tags %}

{% block page_title %}Dataset view{% endblock %}
{% block body_class %}dataset-view{% endblock %}

{% block js %}
    {{ block.super }}
    <script src="{% static 'bower/angular/angular.js' %}"></script>
    <script src="{% static 'bower/angular-route/angular-route.js' %}"></script>
    <script src="{% static 'bower/angular-resource/angular-resource.js' %}"></script>
    <script src="{% static 'bower/angular-cookies/angular-cookies.js' %}"></script>
    <script src="{% static 'djangular/js/django-angular.js' %}"></script>
    <script src="{% static 'data_browser/data_browser.js' %}"></script>
    <script src="{% static 'data_browser/controllers.js' %}"></script>
    <script src="{% static 'data_browser/services.js' %}"></script>
{% endblock %}

{% block bootstrapping %}
    {{ block.super }}
    <script>
        angular.module('ng.django.urls')
                .constant('patterns', {% load_djng_urls %});

        angular.module('message_coding.dataBrowser')
                .constant('django_config', {
                    'STATIC_URL': '{% static '' %}'
                })
                .constant('project_pk', {{ project.pk }})
                .constant('dataset_pk', {{ dataset.pk }});
    </script>
{% endblock %}


{% block content %}

    <div class="container" ng-app="message_coding.dataBrowser">
        <h1>{{ dataset.name }}</h1>

        <p>In project: <a href='{% url 'project' project_slug=project.slug %}'>{{ project.name }}</a></p>


        <p>{{ dataset.description }}</p>

        <p>Owner: {{ dataset.owner }}</p>

        <h3>Messages</h3>

        <form action='{% url 'task_create' project_slug=project.slug %}' method='get'>{% csrf_token %}
            <ul>
                {% for message in dataset.messages.all %}
                    <li><input type='checkbox' id='message' value={{ message.id }} name='messages'
                               checked=checked/> {{ message.text }}</li>
                {% endfor %}
            </ul>
            <input type='hidden' name=dataset value={{ dataset.id }}/>
            <input type='submit' value='Create a task for this project'/>
        </form>

        <div ng-view></div>

    </div>
{% endblock %}
